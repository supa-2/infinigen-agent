# Seed 生成修复说明

## 问题

Infinigen的`parse_seed`函数会将seed字符串作为十六进制解析（如果可能）。这导致：

1. **纯数字字符串**（如 `"303842763"`）会被解析为 `0x303842763 = 12943894371`
2. 这个值超过了 `2**32 - 1 = 4294967295`，导致 `ValueError: Seed must be between 0 and 2**32 - 1`

## 解决方案

直接生成一个**包含字母的十六进制字符串**，确保：

1. 解析后的值不超过 `2**32 - 1`
2. 明确表示这是十六进制格式

### 实现

```python
# 生成1到2**32-1之间的随机整数
max_seed = 2**32 - 1  # 4,294,967,295
seed_int = random.randint(1, max_seed)

# 直接转换为8位十六进制字符串（包含字母）
seed = format(seed_int, '08x')  # 例如: "a1b2c3d4"
```

### 为什么这样有效？

1. `format(seed_int, '08x')` 将整数转换为8位十六进制字符串
2. 如果 `seed_int` 较小（如 `123`），会填充为 `"0000007b"`（包含字母）
3. 解析 `int("0000007b", 16)` = `123`，不会超过范围
4. 如果 `seed_int` 较大（如 `2712847316`），会转换为 `"a1b2c3d4"`（包含字母）
5. 解析 `int("a1b2c3d4", 16)` = `2712847316`，不会超过范围

## 修改的文件

- `src/scene_generator.py`: `generate_scene()` 方法
- `src/agent.py`: `generate_scene_from_request()` 方法

## 测试

运行测试时，应该看到：

```
ℹ 未指定seed，使用随机seed: a1b2c3d4 (解析值: 2712847316)
```

而不是之前的错误。

